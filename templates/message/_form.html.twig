{{ form_start(form, {'attr': {'novalidate': 'novalidate'}}) }}

<div>
    {{ form_label(form.createdBy, "Votre nom") }}
    {{ form_widget(form.createdBy, {'attr': {'placeholder': 'Entrez votre nom', 'class': 'ckeditor-nom'}}) }}
    {{ form_errors(form.createdBy) }}
</div>

<div>
    {{ form_label(form.contenu, "Votre message") }}
    {{ form_widget(form.contenu, {'attr': {'placeholder': 'Ã‰crivez votre message', 'class': 'ckeditor-contenu'}}) }}
    {{ form_errors(form.contenu) }}
</div>

<div>
    <button type="submit" class="btn btn-primary">Modifier</button>
</div>

{{ form_end(form) }}

<!-- Script CKEditor -->
<script src="https://cdn.ckeditor.com/ckeditor5/39.0.0/classic/ckeditor.js"></script>
<script>
    // Attendre que le DOM soit chargÃ©
    document.addEventListener('DOMContentLoaded', function() {
        // Initialiser CKEditor pour le champ nom
        const nomTextarea = document.querySelector('textarea[name*="[createdBy]"]');
        if (nomTextarea) {
            ClassicEditor
                .create(nomTextarea, {
                    toolbar: {
                        items: [
                            'bold', 'italic', '|',
                            'link', 'bulletedList', 'numberedList', '|',
                            'emoji'
                        ]
                    },
                    height: 60,
                    placeholder: 'Entrez votre nom...'
                })
                .then(editor => {
                    // Ajouter un bouton emoji personnalisÃ© pour le champ nom
                    const emojiButtonNom = document.createElement('button');
                    emojiButtonNom.type = 'button';
                    emojiButtonNom.innerHTML = 'ðŸ˜Š';
                    emojiButtonNom.title = 'Ajouter un emoji';
                    emojiButtonNom.style.cssText = 'margin-left: 5px; padding: 4px 8px; border: 1px solid #ccc; background: #fff; cursor: pointer; font-size: 16px;';
                    
                    emojiButtonNom.onclick = () => {
                        const emojiCategories = {
                            'Humains': ['ðŸ‘¶', 'ðŸ§’', 'ðŸ‘¦', 'ðŸ‘§', 'ðŸ§‘', 'ðŸ‘¨', 'ðŸ‘©', 'ðŸ§“', 'ðŸ‘±', 'ðŸ‘¼', 'ðŸ‘´', 'ðŸ‘µ', 'ðŸ‘²', 'ðŸ‘³', 'ðŸ‘®', 'ðŸ‘¯', 'ðŸ‘°', 'ðŸ‘±', 'ðŸ‘²', 'ðŸ‘³', 'ðŸ‘´', 'ðŸ‘µ', 'ðŸ‘¶', 'ðŸ‘·', 'ðŸ‘¸', 'ðŸ‘¹', 'ðŸ‘º', 'ðŸ‘»', 'ï¿½', 'ï¿½ï¿½', 'ðŸ‘¾', 'ðŸ‘¿', 'ðŸ‘¨â€ðŸ«', 'ðŸ‘©â€ðŸ«', 'ðŸ‘¨â€ðŸŽ“', 'ðŸ‘©â€ðŸŽ“', 'ðŸ‘¨â€ðŸŽ¤', 'ðŸ‘©â€ðŸŽ¤', 'ðŸ‘¨â€ðŸŽ¨', 'ðŸ‘©â€ðŸŽ¨', 'ðŸ‘¨â€ðŸ­', 'ðŸ‘©â€ðŸ­', 'ðŸ‘¨â€ðŸ­', 'ðŸ‘©â€ðŸ­', 'ðŸ‘¨â€ðŸ”¬', 'ðŸ‘©â€ðŸ”¬', 'ðŸ‘¨â€ðŸ’»', 'ðŸ‘©â€ðŸ’»', 'ðŸ‘¨â€ðŸ”§', 'ðŸ‘©â€ðŸ”§', 'ðŸ‘¨â€ðŸ—', 'ðŸ‘©â€ðŸ—', 'ðŸ‘¨â€ðŸš€', 'ðŸ‘©â€ðŸš€', 'ðŸ‘¨â€âš•ï¸', 'ðŸ‘©â€âš•ï¸', 'ðŸ‘¨â€âš–ï¸', 'ðŸ‘©â€âš–ï¸', 'ðŸ‘¨â€ðŸŒ¾', 'ðŸ‘©â€ðŸŒ¾', 'ðŸ¤–'],
                            'Visages': ['ðŸ˜€', 'ðŸ˜ƒ', 'ðŸ˜„', 'ðŸ˜', 'ðŸ˜…', 'ðŸ˜‚', 'ðŸ¤£', 'ðŸ˜Š', 'ðŸ˜‡', 'ðŸ™‚', 'ðŸ˜‰', 'ðŸ˜Œ', 'ðŸ˜', 'ðŸ¥°', 'ðŸ˜˜', 'ðŸ˜—', 'ðŸ˜™', 'ðŸ˜š', 'ðŸ˜‹', 'ðŸ˜›', 'ðŸ˜œ', 'ðŸ¤ª', 'ðŸ˜', 'ðŸ¤‘', 'ðŸ¤—', 'ðŸ¤­', 'ðŸ¤«', 'ðŸ¤”', 'ðŸ¤', 'ðŸ¤¨', 'ðŸ˜', 'ðŸ˜‘', 'ðŸ˜¶', 'ðŸ˜', 'ðŸ˜’', 'ðŸ™„', 'ðŸ˜¬', 'ðŸ¤¥', 'ðŸ˜Œ', 'ðŸ˜”', 'ðŸ˜ª', 'ðŸ¤¤', 'ðŸ˜´', 'ðŸ˜·', 'ðŸ¤’', 'ðŸ¤•', 'ðŸ¤¢', 'ðŸ¤®', 'ðŸ¤§', 'ðŸ¥µ', 'ðŸ¥¶', 'ðŸ¥´', 'ðŸ˜µ', 'ðŸ¤¯', 'ðŸ¤ ', 'ðŸ¥³', 'ðŸ˜Ž', 'ðŸ¤“', 'ðŸ§', 'ðŸ˜•', 'ðŸ˜Ÿ', 'ðŸ™', 'â˜¹ï¸', 'ðŸ˜®', 'ðŸ˜¯', 'ðŸ˜²', 'ðŸ˜³', 'ðŸ¥º', 'ðŸ˜¦', 'ðŸ˜§', 'ðŸ˜¨', 'ðŸ˜°', 'ðŸ˜¥', 'ðŸ˜¢', 'ðŸ˜­', 'ðŸ˜±', 'ðŸ˜–', 'ðŸ˜£', 'ðŸ˜ž', 'ðŸ˜“', 'ðŸ˜©', 'ðŸ˜«', 'ðŸ¥±', 'ðŸ˜¤', 'ðŸ˜¡', 'ðŸ˜ ', 'ðŸ¤¬', 'ðŸ˜ˆ', 'ðŸ‘¿', 'ðŸ’€', 'â˜ ï¸', 'ðŸ’©', 'ðŸ¤¡', 'ðŸ‘¹', 'ðŸ‘º', 'ðŸ‘»', 'ðŸ‘½', 'ðŸ‘¾', 'ðŸ¤–'],
                            'Gestes': ['ðŸ‘‹', 'ðŸ¤š', 'ðŸ–ï¸', 'âœ‹', 'ðŸ––', 'ðŸ‘Œ', 'ðŸ¤Œ', 'ðŸ¤', 'âœŒï¸', 'ðŸ¤ž', 'ðŸ¤Ÿ', 'ðŸ¤˜', 'ðŸ¤™', 'ðŸ‘ˆ', 'ðŸ‘‰', 'ðŸ‘†', 'ðŸ‘‡', 'â˜ï¸', 'âœ‹', 'ðŸ¤š', 'ðŸ–ï¸', 'ðŸ––', 'ðŸ‘‹', 'ðŸ¤™', 'ðŸ‘Œ', 'ðŸ¤', 'ðŸ¤ž', 'ðŸ¤Ÿ', 'ðŸ¤˜', 'ðŸ‘ˆ', 'ðŸ‘‰', 'ðŸ‘†', 'ðŸ‘‡', 'â˜ï¸', 'âœŒï¸', 'ðŸ¤ž', 'ðŸ¤Ÿ', 'ðŸ‘', 'ðŸ‘Ž', 'ðŸ‘Š', 'âœŠ', 'ðŸ¤›', 'ðŸ¤œ', 'ðŸ‘', 'ðŸ™Œ', 'ðŸ‘', 'ðŸ¤²', 'ðŸ™', 'ðŸ¤', 'ðŸ’ª', 'ðŸ¦¾', 'ðŸ¦¿', 'ðŸ¦¶', 'ðŸ¦µ', 'ðŸ¦´', 'ðŸ¦¿'],
                            'CÅ“urs': ['â¤ï¸', 'ðŸ§¡', 'ðŸ’›', 'ðŸ’š', 'ðŸ’™', 'ðŸ’œ', 'ðŸ–¤', 'ðŸ¤', 'ðŸ¤Ž', 'ðŸ’”', 'â£ï¸', 'ðŸ’•', 'ðŸ’ž', 'ðŸ’“', 'ðŸ’—', 'ðŸ’–', 'ðŸ’˜', 'ðŸ’', 'ðŸ’Ÿ', 'â›”', 'âœ…', 'â˜‘ï¸', 'âœ”ï¸', 'âŒ', 'âŽ', 'âž•', 'âž–', 'âž—', 'âœ–ï¸', 'â™¾', 'ðŸ’®', 'ðŸ’¯', 'âœ”ï¸', 'â˜‘ï¸', 'ðŸ”˜', 'âšª', 'âš«', 'ðŸ”´', 'ðŸ”µ', 'ðŸŸ¢', 'ðŸŸ¡', 'ðŸŸ ', 'ðŸŸ£', 'ðŸŸ¤', 'ðŸŸ¦', 'ðŸŸ§', 'ðŸŸ¨', 'ðŸŸ©', 'ðŸŸª', 'ðŸŸ«'],
                            'Nourriture': ['ðŸŽ', 'ðŸ', 'ðŸŠ', 'ðŸ‹', 'ðŸŒ', 'ðŸ‰', 'ðŸ‡', 'ðŸ“', 'ðŸˆ', 'ðŸ’', 'ðŸ‘', 'ðŸ¥­', 'ðŸ', 'ðŸ¥¥', 'ðŸ¥', 'ðŸ…', 'ðŸ†', 'ðŸ¥‘', 'ðŸ¥¦', 'ðŸ¥¬', 'ðŸ¥’', 'ðŸŒ¶ï¸', 'ðŸŒ½', 'ðŸ¥•', 'ðŸ«’', 'ðŸ§„', 'ðŸ§…', 'ðŸ¥”', 'ðŸ ', 'ðŸ¥', 'ðŸ¥š', 'ðŸ§ˆ', 'ðŸ¥“', 'ðŸ¥©', 'ðŸ—', 'ðŸ–'],
                            'Sports': ['âš½', 'ðŸ€', 'ðŸˆ', 'âš¾', 'ðŸ¥Ž', 'ðŸŽ¾', 'ðŸ', 'ðŸ‰', 'ðŸ¥', 'ðŸŽ±', 'ðŸ“', 'ðŸ‘', 'ðŸ’', 'ðŸ¥', 'ðŸ', 'ðŸ¥…', 'â›³', 'ðŸ¹', 'ðŸŽ£', 'ðŸ¤¿', 'ðŸ¥Š', 'ðŸ¥‹', 'ðŸ¥Œ', 'ðŸ‡', 'ðŸŠ', 'ðŸ¤¸', 'ðŸ„', 'ðŸš£', 'ðŸš´', 'ðŸšµ', 'ðŸ†', 'ðŸ¥‡', 'ðŸ¥ˆ', 'ðŸ¥‰', 'ðŸ…', 'ðŸŽ–ï¸', 'ðŸµ', 'ðŸŽ—ï¸', 'ðŸŽ«', 'ðŸŽŸï¸', 'ðŸŽª', 'ðŸ¤¹', 'ðŸŽ­', 'ðŸŽ¨', 'ðŸŽ¬', 'ðŸ“½ï¸', 'ðŸŽ¤', 'ðŸŽ§', 'ðŸŽ¼', 'ðŸŽ¹', 'ðŸ¥', 'ðŸŽ·', 'ðŸŽº', 'ðŸŽ¸', 'ðŸª˜', 'ðŸŽ¯', 'ðŸŽ³', 'ðŸŽ®', 'ðŸŽ°', 'ðŸ§©'],
                            'Objets': ['âŒš', 'ðŸ“±', 'ðŸ“²', 'ðŸ’»', 'âŒ¨ï¸', 'ðŸ–¥ï¸', 'ðŸ–¨ï¸', 'ðŸ–±ï¸', 'ðŸ–²', 'ðŸ•¹ï¸', 'ðŸ—œï¸', 'ðŸ’½', 'ðŸ’¾', 'ðŸ’¿', 'ðŸ“€', 'ðŸ“¼', 'ðŸ“·', 'ðŸ“¸', 'ðŸ“¹', 'ðŸ“½', 'ðŸŽ¥', 'ðŸ“º', 'ðŸ“»', 'ðŸ“ž', 'â˜Žï¸', 'ðŸ“Ÿ', 'ðŸ“ ', 'â°', 'â±ï¸', 'â²ï¸', 'ðŸ•°', 'ðŸ•³ï¸', 'ðŸ”‘', 'ðŸ—ï¸', 'ðŸ”’', 'ðŸ”“', 'ðŸ”', 'ðŸ”', 'ðŸ”‘', 'ðŸ—ï¸', 'ðŸ”¨', 'ðŸª“', 'â›ï¸', 'âš’ï¸', 'ðŸ› ï¸', 'ðŸ—¡ï¸', 'âš”ï¸', 'ðŸ”§', 'ðŸ”©', 'âš™ï¸', 'ðŸ—²', 'â›“ï¸', 'ðŸ§²', 'ðŸ”«', 'ðŸ’£', 'ðŸ§¨', 'ðŸ”ª', 'ðŸ—¡ï¸', 'âš”ï¸', 'ðŸ¹', 'ðŸª£', 'ðŸª¤', 'ðŸª¥', 'ðŸª¦', 'ðŸª§', 'ðŸª¨', 'ðŸª©', 'ðŸªª', 'ðŸª«', 'ðŸª¬', 'ðŸª­', 'ðŸª®', 'ðŸª¯', 'ðŸª°', 'ðŸª±', 'ðŸª²', 'ðŸª³', 'ðŸª´', 'ðŸªµ', 'ðŸª¶', 'ðŸª·', 'ðŸª¸', 'ðŸª¹', 'ðŸªº'],
                        };
                        const emojiPickerNom = document.createElement('div');
                        emojiPickerNom.style.cssText = 'position: absolute; background-color: #fff; border: 1px solid #ccc; padding: 10px; display: none; z-index: 1000;';
                        
                        Object.keys(emojiCategories).forEach(category => {
                            const categoryHeader = document.createElement('h3');
                            categoryHeader.textContent = category;
                            categoryHeader.style.cssText = 'margin: 0 0 5px 0; font-size: 14px; color: #333;';
                            emojiPickerNom.appendChild(categoryHeader);
                            
                            const emojis = document.createElement('div');
                            emojis.style.cssText = 'display: flex; flex-wrap: wrap; max-height: 200px; overflow-y: auto;';
                            
                            emojiCategories[category].forEach(emoji => {
                                const emojiButton = document.createElement('button');
                                emojiButton.type = 'button';
                                emojiButton.textContent = emoji;
                                emojiButton.style.cssText = 'margin: 2px; padding: 5px; border: none; border-radius: 3px; cursor: pointer; background: #f0f0f0; font-size: 16px;';
                                
                                emojiButton.onclick = () => {
                                    editor.model.change(writer => {
                                        writer.insertText(emoji, editor.model.document.selection.getFirstPosition());
                                    });
                                    emojiPickerNom.style.display = 'none';
                                };
                                
                                emojis.appendChild(emojiButton);
                            });
                            
                            emojiPickerNom.appendChild(emojis);
                        });
                        document.body.appendChild(emojiPickerNom);
                        
                        emojiButtonNom.onclick = () => {
                            if (emojiPickerNom.style.display === 'none') {
                                emojiPickerNom.style.display = 'block';
                                emojiPickerNom.style.top = emojiButtonNom.offsetTop + emojiButtonNom.offsetHeight + 'px';
                                emojiPickerNom.style.left = emojiButtonNom.offsetLeft + 'px';
                            } else {
                                emojiPickerNom.style.display = 'none';
                            }
                        };
                        
                        // Fermer le picker quand on clique ailleurs
                        document.addEventListener('click', (e) => {
                            if (!emojiPickerNom.contains(e.target) && e.target !== emojiButtonNom) {
                                emojiPickerNom.style.display = 'none';
                            }
                        });
                    };
                    
                    // Ajouter le bouton Ã  la toolbar du champ nom
                    const toolbarNom = editor.ui.view.toolbar.element;
                    toolbarNom.appendChild(emojiButtonNom);
                })
                .catch(error => {
                    console.error('Erreur CKEditor nom:', error);
                });
        }

        // Initialiser CKEditor pour le champ message
        const contenuTextarea = document.querySelector('textarea[name*="[contenu]"]');
        if (contenuTextarea) {
            ClassicEditor
                .create(contenuTextarea, {
                    toolbar: {
                        items: [
                            'Undo','Redo', 
                            'Bold','Italic', 
                            'BulletedList','NumberedList', 
                            'Link','Image','Emoji', 
                            'MathType'
                        ]
                    },
                    height: 150,
                    placeholder: 'Ã‰crivez votre commentaire...'
                })
                .then(editor => {
                    // Ajouter un bouton calculatrice
                    const calculatorButton = document.createElement('button');
                    calculatorButton.type = 'button';
                    calculatorButton.innerHTML = 'ðŸ§®';
                    calculatorButton.title = 'Calculatrice';
                    calculatorButton.style.cssText = 'margin-left: 5px; padding: 4px 8px; border: 1px solid #ccc; background: #fff; cursor: pointer;';
                    calculatorButton.onclick = () => {
                        const result = prompt('Entrez une expression mathÃ©matique (ex: 2+2, 5*3):');
                        if (result) {
                            try {
                                const calculated = eval(result);
                                editor.model.change(writer => {
                                    writer.insertText(calculated.toString(), editor.model.document.selection.getFirstPosition());
                                });
                            } catch (e) {
                                alert('Expression invalide');
                            }
                        }
                    };
                    
                    // Ajouter un bouton Ã©quations mathÃ©matiques
                    const mathButton = document.createElement('button');
                    mathButton.type = 'button';
                    mathButton.innerHTML = 'âˆ‘';
                    mathButton.title = 'Ã‰quations mathÃ©matiques';
                    mathButton.style.cssText = 'margin-left: 5px; padding: 4px 8px; border: 1px solid #ccc; background: #fff; cursor: pointer;';
                    mathButton.onclick = () => {
                        const equation = prompt('Entrez une Ã©quation mathÃ©matique (ex: x^2 + y^2 = z^2):');
                        if (equation) {
                            editor.model.change(writer => {
                                const text = `[${equation}]`;
                                writer.insertText(text, editor.model.document.selection.getFirstPosition());
                            });
                        }
                    };
                    
                    // Ajouter un bouton emoji personnalisÃ©
                    const emojiButton = document.createElement('button');
                    emojiButton.type = 'button';
                    emojiButton.innerHTML = 'ðŸ˜Š';
                    emojiButton.title = 'Ajouter un emoji';
                    emojiButton.style.cssText = 'margin-left: 5px; padding: 4px 8px; border: 1px solid #ccc; background: #fff; cursor: pointer; font-size: 16px;';
                    
                    emojiButton.onclick = () => {
                        const emojiCategories = {
                            'Humains': ['ðŸ‘¶', 'ðŸ§’', 'ðŸ‘¦', 'ðŸ‘§', 'ðŸ§‘', 'ðŸ‘¨', 'ðŸ‘©', 'ðŸ§“', 'ðŸ‘±', 'ðŸ‘¼', 'ðŸ‘´', 'ðŸ‘µ', 'ðŸ‘²', 'ðŸ‘³', 'ðŸ‘®', 'ðŸ‘¯', 'ðŸ‘°', 'ðŸ‘±', 'ðŸ‘²', 'ðŸ‘³', 'ðŸ‘´', 'ðŸ‘µ', 'ðŸ‘¶', 'ðŸ‘·', 'ðŸ‘¸', 'ðŸ‘¹', 'ðŸ‘º', 'ðŸ‘»', 'ï¿½', 'ï¿½ï¿½', 'ðŸ‘¾', 'ðŸ‘¿', 'ðŸ‘¨â€ðŸ«', 'ðŸ‘©â€ðŸ«', 'ðŸ‘¨â€ðŸŽ“', 'ðŸ‘©â€ðŸŽ“', 'ðŸ‘¨â€ðŸŽ¤', 'ðŸ‘©â€ðŸŽ¤', 'ðŸ‘¨â€ðŸŽ¨', 'ðŸ‘©â€ðŸŽ¨', 'ðŸ‘¨â€ðŸ­', 'ðŸ‘©â€ðŸ­', 'ðŸ‘¨â€ðŸ­', 'ðŸ‘©â€ðŸ­', 'ðŸ‘¨â€ðŸ”¬', 'ðŸ‘©â€ðŸ”¬', 'ðŸ‘¨â€ðŸ’»', 'ðŸ‘©â€ðŸ’»', 'ðŸ‘¨â€ðŸ”§', 'ðŸ‘©â€ðŸ”§', 'ðŸ‘¨â€ðŸ—', 'ðŸ‘©â€ðŸ—', 'ðŸ‘¨â€ðŸš€', 'ðŸ‘©â€ðŸš€', 'ðŸ‘¨â€âš•ï¸', 'ðŸ‘©â€âš•ï¸', 'ðŸ‘¨â€âš–ï¸', 'ðŸ‘©â€âš–ï¸', 'ðŸ‘¨â€ðŸŒ¾', 'ðŸ‘©â€ðŸŒ¾', 'ðŸ¤–'],
                            'Visages': ['ðŸ˜€', 'ðŸ˜ƒ', 'ðŸ˜„', 'ðŸ˜', 'ðŸ˜…', 'ðŸ˜‚', 'ðŸ¤£', 'ðŸ˜Š', 'ðŸ˜‡', 'ðŸ™‚', 'ðŸ˜‰', 'ðŸ˜Œ', 'ðŸ˜', 'ðŸ¥°', 'ðŸ˜˜', 'ðŸ˜—', 'ðŸ˜™', 'ðŸ˜š', 'ðŸ˜‹', 'ðŸ˜›', 'ðŸ˜œ', 'ðŸ¤ª', 'ðŸ˜', 'ðŸ¤‘', 'ðŸ¤—', 'ðŸ¤­', 'ðŸ¤«', 'ðŸ¤”', 'ðŸ¤', 'ðŸ¤¨', 'ðŸ˜', 'ðŸ˜‘', 'ðŸ˜¶', 'ðŸ˜', 'ðŸ˜’', 'ðŸ™„', 'ðŸ˜¬', 'ðŸ¤¥', 'ðŸ˜Œ', 'ðŸ˜”', 'ðŸ˜ª', 'ðŸ¤¤', 'ðŸ˜´', 'ðŸ˜·', 'ðŸ¤’', 'ðŸ¤•', 'ðŸ¤¢', 'ðŸ¤®', 'ðŸ¤§', 'ðŸ¥µ', 'ðŸ¥¶', 'ðŸ¥´', 'ðŸ˜µ', 'ðŸ¤¯', 'ðŸ¤ ', 'ðŸ¥³', 'ðŸ˜Ž', 'ðŸ¤“', 'ðŸ§', 'ðŸ˜•', 'ðŸ˜Ÿ', 'ðŸ™', 'â˜¹ï¸', 'ðŸ˜®', 'ðŸ˜¯', 'ðŸ˜²', 'ðŸ˜³', 'ðŸ¥º', 'ðŸ˜¦', 'ðŸ˜§', 'ðŸ˜¨', 'ðŸ˜°', 'ðŸ˜¥', 'ðŸ˜¢', 'ðŸ˜­', 'ðŸ˜±', 'ðŸ˜–', 'ðŸ˜£', 'ðŸ˜ž', 'ðŸ˜“', 'ðŸ˜©', 'ðŸ˜«', 'ðŸ¥±', 'ðŸ˜¤', 'ðŸ˜¡', 'ðŸ˜ ', 'ðŸ¤¬', 'ðŸ˜ˆ', 'ðŸ‘¿', 'ðŸ’€', 'â˜ ï¸', 'ðŸ’©', 'ðŸ¤¡', 'ðŸ‘¹', 'ðŸ‘º', 'ðŸ‘»', 'ðŸ‘½', 'ðŸ‘¾', 'ðŸ¤–'],
                            'Gestes': ['ðŸ‘‹', 'ðŸ¤š', 'ðŸ–ï¸', 'âœ‹', 'ðŸ––', 'ðŸ‘Œ', 'ðŸ¤Œ', 'ðŸ¤', 'âœŒï¸', 'ðŸ¤ž', 'ðŸ¤Ÿ', 'ðŸ¤˜', 'ðŸ¤™', 'ðŸ‘ˆ', 'ðŸ‘‰', 'ðŸ‘†', 'ðŸ‘‡', 'â˜ï¸', 'âœ‹', 'ðŸ¤š', 'ðŸ–ï¸', 'ðŸ––', 'ðŸ‘‹', 'ðŸ¤™', 'ðŸ‘Œ', 'ðŸ¤', 'ðŸ¤ž', 'ðŸ¤Ÿ', 'ðŸ¤˜', 'ðŸ‘ˆ', 'ðŸ‘‰', 'ðŸ‘†', 'ðŸ‘‡', 'â˜ï¸', 'âœŒï¸', 'ðŸ¤ž', 'ðŸ¤Ÿ', 'ðŸ‘', 'ðŸ‘Ž', 'ðŸ‘Š', 'âœŠ', 'ðŸ¤›', 'ðŸ¤œ', 'ðŸ‘', 'ðŸ™Œ', 'ðŸ‘', 'ðŸ¤²', 'ðŸ™', 'ðŸ¤', 'ðŸ’ª', 'ðŸ¦¾', 'ðŸ¦¿', 'ðŸ¦¶', 'ðŸ¦µ', 'ðŸ¦´', 'ðŸ¦¿'],
                            'CÅ“urs': ['â¤ï¸', 'ðŸ§¡', 'ðŸ’›', 'ðŸ’š', 'ðŸ’™', 'ðŸ’œ', 'ðŸ–¤', 'ðŸ¤', 'ðŸ¤Ž', 'ðŸ’”', 'â£ï¸', 'ðŸ’•', 'ðŸ’ž', 'ðŸ’“', 'ðŸ’—', 'ðŸ’–', 'ðŸ’˜', 'ðŸ’', 'ðŸ’Ÿ', 'â›”', 'âœ…', 'â˜‘ï¸', 'âœ”ï¸', 'âŒ', 'âŽ', 'âž•', 'âž–', 'âž—', 'âœ–ï¸', 'â™¾', 'ðŸ’®', 'ðŸ’¯', 'âœ”ï¸', 'â˜‘ï¸', 'ðŸ”˜', 'âšª', 'âš«', 'ðŸ”´', 'ðŸ”µ', 'ðŸŸ¢', 'ðŸŸ¡', 'ðŸŸ ', 'ðŸŸ£', 'ðŸŸ¤', 'ðŸŸ¦', 'ðŸŸ§', 'ðŸŸ¨', 'ðŸŸ©', 'ðŸŸª', 'ðŸŸ«'],
                            'Nourriture': ['ðŸŽ', 'ðŸ', 'ðŸŠ', 'ðŸ‹', 'ðŸŒ', 'ðŸ‰', 'ðŸ‡', 'ðŸ“', 'ðŸˆ', 'ðŸ’', 'ðŸ‘', 'ðŸ¥­', 'ðŸ', 'ðŸ¥¥', 'ðŸ¥', 'ðŸ…', 'ðŸ†', 'ðŸ¥‘', 'ðŸ¥¦', 'ðŸ¥¬', 'ðŸ¥’', 'ðŸŒ¶ï¸', 'ðŸŒ½', 'ðŸ¥•', 'ðŸ«’', 'ðŸ§„', 'ðŸ§…', 'ðŸ¥”', 'ðŸ ', 'ðŸ¥', 'ðŸ¥š', 'ðŸ§ˆ', 'ðŸ¥“', 'ðŸ¥©', 'ðŸ—', 'ðŸ–'],
                            'Sports': ['âš½', 'ðŸ€', 'ðŸˆ', 'âš¾', 'ðŸ¥Ž', 'ðŸŽ¾', 'ðŸ', 'ðŸ‰', 'ðŸ¥', 'ðŸŽ±', 'ðŸ“', 'ðŸ‘', 'ðŸ’', 'ðŸ¥', 'ðŸ', 'ðŸ¥…', 'â›³', 'ðŸ¹', 'ðŸŽ£', 'ðŸ¤¿', 'ðŸ¥Š', 'ðŸ¥‹', 'ðŸ¥Œ', 'ðŸ‡', 'ðŸŠ', 'ðŸ¤¸', 'ðŸ„', 'ðŸš£', 'ðŸš´', 'ðŸšµ', 'ðŸ†', 'ðŸ¥‡', 'ðŸ¥ˆ', 'ðŸ¥‰', 'ðŸ…', 'ðŸŽ–ï¸', 'ðŸµ', 'ðŸŽ—ï¸', 'ðŸŽ«', 'ðŸŽŸï¸', 'ðŸŽª', 'ðŸ¤¹', 'ðŸŽ­', 'ðŸŽ¨', 'ðŸŽ¬', 'ðŸ“½ï¸', 'ðŸŽ¤', 'ðŸŽ§', 'ðŸŽ¼', 'ðŸŽ¹', 'ðŸ¥', 'ðŸŽ·', 'ðŸŽº', 'ðŸŽ¸', 'ðŸª˜', 'ðŸŽ¯', 'ðŸŽ³', 'ðŸŽ®', 'ðŸŽ°', 'ðŸ§©'],
                            'Objets': ['âŒš', 'ðŸ“±', 'ðŸ“²', 'ðŸ’»', 'âŒ¨ï¸', 'ðŸ–¥ï¸', 'ðŸ–¨ï¸', 'ðŸ–±ï¸', 'ðŸ–²', 'ðŸ•¹ï¸', 'ðŸ—œï¸', 'ðŸ’½', 'ðŸ’¾', 'ðŸ’¿', 'ðŸ“€', 'ðŸ“¼', 'ðŸ“·', 'ðŸ“¸', 'ðŸ“¹', 'ðŸ“½', 'ðŸŽ¥', 'ðŸ“º', 'ðŸ“»', 'ðŸ“ž', 'â˜Žï¸', 'ðŸ“Ÿ', 'ðŸ“ ', 'â°', 'â±ï¸', 'â²ï¸', 'ðŸ•°', 'ðŸ•³ï¸', 'ðŸ”‘', 'ðŸ—ï¸', 'ðŸ”’', 'ðŸ”“', 'ðŸ”', 'ðŸ”', 'ðŸ”‘', 'ðŸ—ï¸', 'ðŸ”¨', 'ðŸª“', 'â›ï¸', 'âš’ï¸', 'ðŸ› ï¸', 'ðŸ—¡ï¸', 'âš”ï¸', 'ðŸ”§', 'ðŸ”©', 'âš™ï¸', 'ðŸ—²', 'â›“ï¸', 'ðŸ§²', 'ðŸ”«', 'ðŸ’£', 'ðŸ§¨', 'ðŸ”ª', 'ðŸ—¡ï¸', 'âš”ï¸', 'ðŸ¹', 'ðŸª£', 'ðŸª¤', 'ðŸª¥', 'ðŸª¦', 'ðŸª§', 'ðŸª¨', 'ðŸª©', 'ðŸªª', 'ðŸª«', 'ðŸª¬', 'ðŸª­', 'ðŸª®', 'ðŸª¯', 'ðŸª°', 'ðŸª±', 'ðŸª²', 'ðŸª³', 'ðŸª´', 'ðŸªµ', 'ðŸª¶', 'ðŸª·', 'ðŸª¸', 'ðŸª¹', 'ðŸªº'],
                        };

                        const emojiPicker = document.createElement('div');
                        emojiPicker.style.cssText = 'position: absolute; background-color: #fff; border: 1px solid #ccc; padding: 10px; z-index: 1000;';

                        Object.keys(emojiCategories).forEach(category => {
                            const categoryHeader = document.createElement('h3');
                            categoryHeader.textContent = category;
                            categoryHeader.style.cssText = 'margin: 0 0 5px 0; font-size: 14px; color: #333;';
                            emojiPicker.appendChild(categoryHeader);

                            const emojis = document.createElement('div');
                            emojis.style.cssText = 'display: flex; flex-wrap: wrap; max-height: 200px; overflow-y: auto;';

                            emojiCategories[category].forEach(emoji => {
                                const emojiButton = document.createElement('button');
                                emojiButton.type = 'button';
                                emojiButton.textContent = emoji;
                                emojiButton.style.cssText = 'margin: 2px; padding: 5px; border: none; border-radius: 3px; cursor: pointer; background: #f0f0f0; font-size: 16px;';

                                emojiButton.onclick = () => {
                                    editor.model.change(writer => {
                                        writer.insertText(emoji, editor.model.document.selection.getFirstPosition());
                                    });
                                    emojiPicker.remove();
                                };

                                emojis.appendChild(emojiButton);
                            });

                            emojiPicker.appendChild(emojis);
                        });

                        document.body.appendChild(emojiPicker);

                        emojiButton.onclick = () => {
                            const rect = emojiButton.getBoundingClientRect();
                            emojiPicker.style.top = emojiButton.offsetTop + emojiButton.offsetHeight + 'px';
                            emojiPicker.style.left = emojiButton.offsetLeft + 'px';
                        };
                        
                        // Fermer le picker quand on clique ailleurs
                        document.addEventListener('click', (e) => {
                            if (!emojiPicker.contains(e.target) && e.target !== emojiButton) {
                                emojiPicker.style.display = 'none';
                            }
                        });
                    };
                    
                    // Ajouter les boutons Ã  la toolbar
                    const toolbar = editor.ui.view.toolbar.element;
                    toolbar.appendChild(calculatorButton);
                    toolbar.appendChild(mathButton);
                    toolbar.appendChild(emojiButton);
                })
                .catch(error => {
                    console.error('Erreur CKEditor message:', error);
                });
        }
    });
</script>
